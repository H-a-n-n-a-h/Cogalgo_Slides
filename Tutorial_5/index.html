<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="../dist/reset.css">
		<link rel="stylesheet" href="../dist/reveal.css">
		<link rel="stylesheet" href="../dist/theme/black.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="../plugin/highlight/monokai.css">
		<!-- MathJax for LaTeX -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	</head>

  <style>
:root {
  --nicecyan:   #00CC99;  /* (0,0.8,0.6) */
  --niceblue:   #4D66FF;  /* (0.3,0.4,1) */
  --nicepurple: #FF1AFF;  /* (1,0.1,1) */
  --nicered:    #CC001A;  /* (0.8,0,0.1) */
  --niceyellow: #FFB300;  /* (1,0.7,0) */
  --niceorange: #FF8000;  /* (1,0.5,0) */
  --offwhite:   #FFE6FF;  /* (1,0.9,1) */
}
</style>

	<body>
<div class="reveal">
  <div class="slides">

    <!-- Slide 1: Title -->
    <section>
      <h2 style="color:#A8E6CF;">Cognitive Algorithms: Dimensionality Reduction</h2>
      <p style="color:#EAEAEA;">Hannah Louisa Boldt h.boldt@campus.tu-berlin.de</p>
    </section>

<section>
  <h3 style="color:#A8E6CF; text-align:center; text-transform: none">Organization</h3>
  
    
	<p style="color:#8A8A8A; font-size:0.7em; margin-top:5px;">
Next tutorial will be in person in Mar.0001 again!  
</section>


<section>
  <h3 style="color:#A8E6CF; text-align:center; text-transform: none">Course Structure</h3>
  <svg id="tree1" width="700" height="600"></svg>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    const data = {
      name: "Machine Learning",
      children: [
        {
          name: "Supervised Learning",
          children: [
            { name: "Regression", children: [{ name: "Linear Regression", children: [{ name: "Kernel Ridge Regression"}]}] },
            { name: "Classification", children: [{ name: "Binary Classification", children: [{ name: "LDA"},{ name: "Perceptron"},{ name: "NCC"}]}] },
          ]
        },
        {
          name: "Unsupervised Learning",
          children: [
            { name: "Clustering", children: [{ name: "k-Means"}] },
            { name: "Dimension Reduction", children: [{ name: "NMF"}, { name: "PCA", children: [{ name: "kPCA"}]}] }
          ]
        }
      ]
    };

    function drawTree(svgId, highlight=false) {
      const width = 700, height = 600;
      const treeLayout = d3.tree().size([width, height - 100]);
      const root = d3.hierarchy(data);
      treeLayout(root);

      const svg = d3.select(svgId)
        .append("g")
        .attr("transform", "translate(50,50)");

      const highlightNames = new Set([
        "Machine Learning",
        "Unsupervised Learning",
        "Clustering",
        "k-Means",
        "Dimension Reduction",
        "NMF",
        "PCA",
        "kPCA",
      ]);

      function isHighlighted(link) {
        const src = link.source.data.name;
        const tgt = link.target.data.name;
        return highlight && highlightNames.has(src) && highlightNames.has(tgt);
      }

      // Draw links
      svg.selectAll("path")
        .data(root.links())
        .enter()
        .append("path")
        .attr("d", d3.linkVertical().x(d => d.x).y(d => d.y))
        .attr("stroke", d => isHighlighted(d) ? "#00FF9C" : "#A8E6CF")
        .attr("stroke-width", d => isHighlighted(d) ? 3 : 2)
        .attr("fill", "none");

      // Draw nodes
      svg.selectAll("circle")
        .data(root.descendants())
        .enter()
        .append("circle")
        .attr("cx", d => d.x)
        .attr("cy", d => d.y)
        .attr("r", 6)
        .attr("fill", d => (highlight && highlightNames.has(d.data.name)) ? "#00FF9C" : "#FFD166");

      // Draw labels
      svg.selectAll("text")
        .data(root.descendants())
        .enter()
        .append("text")
        .attr("x", d => d.children ? d.x - 10 : d.x)
        .attr("y", d => d.children ? d.y + 5 : d.y + 20)
        .attr("text-anchor", d => d.children ? "end" : "middle")
        .attr("fill", d => (highlight && highlightNames.has(d.data.name)) ? "#00FF9C" : "#EAEAEA")
        .style("font-size", "16px")
        .text(d => d.data.name);
    }

    drawTree("#tree1", false);
  </script>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none">Today</h3>
  <svg id="tree2" width="700" height="600"></svg>
                <!-- Question highlighted -->
  
  <script>
    drawTree("#tree2", true);
  </script>
</section>

<section>
 <h3 style="color:#A8E6CF; text-align:middle; text-transform: none; font-size:1.1em;">Recap Supervised</h3>
       <a href="../other/" class="shake-on-hover" style="color:#13DAEC; text-decoration: none; font-weight: normal;font-size:0.8em;">
          Supervised Learning Models Overview
        </a>
</section>

<section>
 <h3 style="color:#A8E6CF; text-align:middle; text-transform: none; font-size:1.1em;">Recap Kernels</h3>
       <a href="../Tutorial_4/#/12" class="shake-on-hover" style="color:#13DAEC; text-decoration: none; font-weight: normal;font-size:0.8em;">
          Kernel function
        </a>
        <br>
         <a href="../Tutorial_4/#/27" class="shake-on-hover" style="color:#13DAEC; text-decoration: none; font-weight: normal;font-size:0.8em;">
          Interactive: RBF Kernel Regression
        </a>
</section>





<section>
  <h3 style="color:#A8E6CF; text-align:middle; text-transform: none; font-size:1.1em;">Dimensionality Reduction</h3>
  <div style="text-align:center;">
     
    <img src="../img/projection_onto_xy.gif" width="500" style="display:block; margin: 0 auto;">
    
      <p style="color:#8A8A8A; font-size:0.5em; text-align:center; margin-top:5px;">
    \[

      \underbrace{\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \end{bmatrix} }_{\text{projection}}
      X
      = X_{projected} 
    \]
  </p>
  </div>
</section>



<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none; font-size:1.0em;">Approach 1: Maximize Variance in Projected Space</h3>

  <div style="display:flex; justify-content:center; align-items:center; gap:20px; margin-top:10px;">
    <img src="../img/projection_loop_one_class.gif" width="600">
    <img src="../img/projection_loop_one_class_max_variance.webp" width="600">
  </div>

  <p style="color:#8A8A8A; font-size:0.5em; text-align:center; margin-top:5px;">
    Left shows all possible projections in lower dimensional subspace. Right shows projection one subspace that maximizes variance.
  </p>

</section>

<section>
  <h3 style="color:#A8E6CF; text-align:center; text-transform: none">Approach 1: Maximize Variance in Projected Space</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/projection_loop_one_class_max_variance.webp" width="700" style="display:block; margin: 0 auto;">
    
  	   <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Which algorithm from the lecture uses this approach?
    </p>
    <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      PCA!
    </p>
  </div>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none; font-size:1.0em;">
    Principal Component Analysis
  </h3>

  <div style="margin-top:10px;font-size:0.8em; padding-left:10px;">
    <ol>
      <li>Compute empirical covariance matrix \(\frac{1}{n} XX^\top = \Sigma_x \in \mathbb{R}^{d \times d}\)</li>
      <li>Compute eigenvalues of \(\Sigma_x\)</li>
      <li>
        For the \(k\) largest eigenvalues \(\lambda_1, \dots, \lambda_k \in \mathbb{R}\), calculate corresponding eigenvectors \(w_1, \dots, w_k \in \mathbb{R}^d\)  
        and form the projection matrix:
        \[
          W = 
          \begin{bmatrix}
            | & | & \dots & | \\
            w_1 & w_2 & \dots & w_k \\
            | & | & \dots & |
          \end{bmatrix}
        \]
      </li>
      <li>Project data: \(H = W^\top X\)</li>
      <li>For reconstruction: \(X \approx W \cdot H\)</li>
    </ol>
  </div>

  <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px; font-size:0.7em;">
    For centered data!
  </p>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none; font-size:1.0em;">
    (Linear) kernel PCA
  </h3>

  <div style="margin-top:10px; font-size:0.8em;  padding-left:10px;">
    <ol>
      <li>Compute kernel matrix \(K = X^\top X \in \mathbb{R}^{n \times n}\)</li>
      <li>Compute eigenvalues of \(K\).</li>
      <li>
        For the \(k\) largest eigenvalues \(\lambda_1, \dots, \lambda_k \in \mathbb{R}\), compute corresponding eigenvectors \(v_1, \dots, v_k \in \mathbb{R}^n\).  
        Form matrix \(\alpha\) and projection:
        \[
          \alpha = 
          \begin{bmatrix}
            | & | & \dots & | \\
            v_1 & v_2 & \dots & v_k \\
            | & | & \dots & |
          \end{bmatrix}, \quad
          W = X \alpha
        \]
      </li>
      <li>Project data: \(H = W^\top X\)</li>
      <li>For reconstruction: \(X \approx W \cdot H\)</li>
    </ol>
  </div>

  <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px; font-size:0.7em;">
    For centered data! Same result as PCA, different complexity.
  </p>
</section>



<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">PCA: Plotting with latent variables</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/PCA_visualization_example.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
    Source: Opportunistic or Non-Random Wildlife Crime? Attractiveness Rather Than Abundance in the Wild Leads to Selective Parrot Poaching
  </p>
  </div>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none; font-size:1.0em;">Approach 2: Clustering</h3>

  <div style="display:flex; justify-content:center; align-items:center; gap:20px; margin-top:10px;">
    <img src="../img/kmeansin.png" width="400">
    <img src="../img/kmeansout.png" width="400">
  </div>

  <p style="color:#8A8A8A; font-size:0.5em; text-align:center; margin-top:5px;">
   We want to find k clusters. In this image we use k = 3.
  </p>
  	   <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Which algorithm from the lecture uses this approach?
    </p>
    <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      k Means!
    </p>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform:none; font-size:1.0em;">
    k-means algorithm
  </h3>

  <div style="margin-top:10px; font-size:0.6em; padding-left:10px;">
    <ol>

        Let \(X \in \mathbb{R}^{n \times d}\) be the data matrix containing
        \(n\) data points \(\mathbf{x}_i \in \mathbb{R}^d\).
    

      <li>
        Initialize \(k\) cluster vectors \(c_j \in \mathbb{R}^d\) randomly then
        \[
          C =
          \begin{bmatrix}
            | & | & \dots & | \\
            c_1 & c_2 & \dots & c_k \\
            | & | & \dots & |
          \end{bmatrix}
          \in \mathbb{R}^{d \times k}.
        \]
        Each column represents one cluster center.
      </li>

      <li>
        
        For each datapoint $\mathbf{x}_i$ assign to clusterpoint based on distance  
        then assignment matrix
        \[
          Y =
          \begin{bmatrix}
            | & | & \dots & | \\
            y_1 & y_2 & \dots & y_k \\
            | & | & \dots & |
          \end{bmatrix}
          \in \{0,1\}^{n \times k},
        \]
        where \(y_{ij} = 1\) iff \(\mathbf{x}_i\) is assigned to cluster \(j\).
      </li>

      <li>
        Update each cluster center by  the mean of all data points
        assigned to that cluster.
      </li>

      <li>
        Repeat 2. and 3. until either a maximum number of iterations is
        reached or the cluster centers change by less than
        \(\varepsilon > 0\).
      </li>

    </ol>
  </div>
</section>


  <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px; font-size:0.7em;">
    This finds k classes in data.
  </p>
</section>


<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform: none; font-size:1.0em;">Approach 3: Minimize Distance between matrices directly</h3>

  <div style="display:flex; justify-content:center; align-items:center; gap:20px; margin-top:10px;">
 \begin{align*}
    \text{argmin}_{W,H} \sum_{i = 1}^d \sum_{j = 1}^n (X_{ij} - (WH)_{ij})^2
\end{align*}
  </div>

  <p style="color:#8A8A8A; font-size:0.5em; text-align:center; margin-top:5px;">
    Sum of all squared distances of each entry of the matrix.
  </p>

     <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;"> What is the distance between $X$ and $WH$ given
        $$ X = \begin{bmatrix}
            1 & 0 & 0  \\
            1 & 2 & 1 
          \end{bmatrix},  
          W = \begin{bmatrix}
            0 \\ 1       
          \end{bmatrix},  
          H = \begin{bmatrix}
            1 & 1 & 1      
          \end{bmatrix}?
           $$
    </p>
      	   <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Which algorithm from the lecture uses this approach?
    </p>
    <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      NMF!
    </p>
  
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:left; text-transform:none; font-size:1.0em;">
    Non negative matrix factorization algorithm
  </h3>
  Gradient descent finds optimal solution!
  <div>
  $$ H \leftarrow H - \eta ( W^\top WH - W^\top X )$$
  $$ W \leftarrow W - \eta ( WHH^\top  - XH^\top  )$$
  </div>
    <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Can also be transformed into...
    </p>

      <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
        $$  H = H \odot W ^\top X \oslash W^\top WH
        $$
     $$ W = W \odot XH^\top \oslash WHH^\top$$
    </p>
</section>

<section>
 Quick Break
   <p style="color:#8A8A8A; font-size:0.7em; margin-top:5px;">
		Jupiter Notebook showing example code
	  </p>
</section>



<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Example: Bliss</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      An image is just 3 matrices.
    </p>

</section>

<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Example: Bliss BW</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_bw.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      A black and white image is just a matrix.
    </p>
</section>


<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Example: Bliss PCA</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_pca_10.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      This is using k = 10 and this is the reconstructed image.
    </p>
</section>

<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Example: Bliss NMF</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_nmf_10.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      This is using k = 10 and this is the reconstructed image.
    </p>
</section>


<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Lets find edges!</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Let's use a simple edge detector. 
    </p>

</section>


<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Lets find edges!</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_edges.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Hmmm.. :/ 
    </p>
          <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      Let's preprocess the image!
    </p>

</section>



<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Color clustering</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_kmeans_3.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>
      <!-- Question highlighted -->
    <p class="fragment" style="color:#FFD166; font-weight:bold; margin-top:20px;font-size:0.7em;">
      We use k = 3 because of green (grass), blue (sky) and white (cloud). 
    </p>
</section>



<section>
  <h3 style="color:#A8E6CF; text-align:center; font-size:1.0; text-transform: none">Edges detector on preprocessed image</h3>
  
  <div style="text-align:center;">
     
    <img src="../img/bliss_edges_k3.png" width="700" style="display:block; margin: 0 auto;">
      <p style="color:#8A8A8A; font-size:0.3em; text-align:center; margin-top:5px;">
  </p>
  </div>

</section>
    <section>
      <h3 style="color:#A8E6CF; text-align:center; text-transform: none">Questions for upcoming Homework?</h3>
    </section>


		<script src="../dist/reveal.js"></script>
		<script src="../plugin/notes/notes.js"></script>
		<script src="../plugin/markdown/markdown.js"></script>
		<script src="../plugin/highlight/highlight.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
		<script src="../plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
  				transition: 'none',           // default: no transition
  				backgroundTransition: 'none', // default: no background fade
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.MathJax3  ],
				  math: {
					  mathjax: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js",
					config: {
					tex: {
						macros: {
						R: "\\mathbb{R}",
						bw: "\\mathbf{w}",
						bx: "\\mathbf{x}",
						sign: "\\operatorname{sign}"
						}
					}
					}
				}
			});
		</script>
	</body>
</html>